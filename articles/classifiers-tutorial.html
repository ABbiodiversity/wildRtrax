<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Acoustic classifiers • wildrtrax</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Acoustic classifiers">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wildrtrax</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/apis.html">APIs</a></li>
    <li><a class="dropdown-item" href="../articles/audio-data-concepts.html">Audio data concepts</a></li>
    <li><a class="dropdown-item" href="../articles/acoustic-pre-processing.html">Acoustic pre-processing</a></li>
    <li><a class="dropdown-item" href="../articles/acoustic-data-wrangling.html">Acoustic data wrangling</a></li>
    <li><a class="dropdown-item" href="../articles/classifiers-tutorial.html">Acoustic classifiers</a></li>
    <li><a class="dropdown-item" href="../articles/camera-data-wrangling.html">Camera data wrangling</a></li>
    <li><a class="dropdown-item" href="../articles/tutorials.html">Tutorials</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 1.3.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 1.2.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 1.1.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 1.0.1</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 1.0.0</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>wildrtrax 0.1.0</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Acoustic classifiers</h1>
            
      

      <div class="d-none name"><code>classifiers-tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="deep-learning-in-acoustic-processing">Deep learning in acoustic processing<a class="anchor" aria-label="anchor" href="#deep-learning-in-acoustic-processing"></a>
</h2>
<p>Recent advances in deep learning have led to the development of
neural network models that can classify the sounds within acoustic
recordings, such as those captured by autonomous recording units (ARUs).
These classifiers can be trained to detect just a single focal species,
or to classify thousands of species. The process of using automated
classifiers to extract species detections from acoustic recordings is
collectively called “computer listening”. This tutorial will show you
how to access and work with classifier results for recordings in
WildTrax.</p>
<div class="section level3">
<h3 id="birdnet">BirdNET<a class="anchor" aria-label="anchor" href="#birdnet"></a>
</h3>
<p><a href="https://birdnet.cornell.edu/" class="external-link">BirdNET</a> is a deep learning
classifier developed by the Cornell Lab of Ornithology that is trained
to classify more than 6,000 of the world’s most common bird species,
including most North American bird species <span class="citation">@kahl_2022</span>. The model converts audio recordings
into windows of spectrograms and outputs a probability score for each
species in each one.</p>
</div>
<div class="section level3">
<h3 id="classifier-performance">Classifier performance<a class="anchor" aria-label="anchor" href="#classifier-performance"></a>
</h3>
<p>Classifier scores can be converted to species detections by setting a
threshold (e.g., 0.8) above which to consider a species present within a
given spectrogram <span class="citation">@wood_2024</span>. False
positives can still occur at high score thresholds, so often
verification by a human observer is still necessary.</p>
<p>Choosing a score threshold will depend on the goals of the project;
however, threshold choice is a trade-off between false positives (i.e.,
incorrect classifications) and false negatives (i.e., missed detections;
<span class="citation">@priyadarshani_2018</span>, <span class="citation">@knight_2017</span>). Choosing a high score threshold
will minimize false positives, but will also result in false negatives.
Choosing a low score threshold will minimize false negatives but will
result in many false positives. The proportion of false positives at a
given score threshold is typically measured by precision:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>t</mi><mi>p</mi></mrow><mrow><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>p</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">precision = \frac{tp}{tp + fp}</annotation></semantics></math></p>
<p>While the proportion of false negatives is measured as recall:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>t</mi><mi>p</mi></mrow><mrow><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>n</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">recall = \frac{tp}{tp + fn}</annotation></semantics></math></p>
<p>Where <em>tp</em> is the number of true positives, <em>fp</em> is the
number of false positives, and <em>fn</em> is the number of false
negatives.</p>
<p>The threshold-agnostic performance of a classifier is then typically
evaluated as the area under the curve (AUC) of a precision-recall curve.
The corner of the precision recall curve can be used to select a score
threshold.</p>
<p>F-score is a combination of precision and recall and can also used to
select a score threshold by selecting the peak value.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mo>*</mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>*</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi></mrow><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>+</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Fscore = \frac{2 * precision* recall}{precision + recall}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="birdnet-performance-for-canadian-birds">BirdNET performance for Canadian birds<a class="anchor" aria-label="anchor" href="#birdnet-performance-for-canadian-birds"></a>
</h3>
<p>ABMI has evaluated BirdNET with a dataset of 623 3-minute recordings.
All species were annotated in each minute of each recording by our top
expert listeners and further groomed for false positives and negatives.
The dataset was selected to include at least 10 recordings with
detections of the most common 203 Canadian bird species. Recordings were
primarily sourced from Alberta and Ontario to include variation in
dialect. We evaluated BirdNET by running it using the local eBird
occurrence data for each recording and comparing results with our expert
dataset and pooling the total detections across species per minute of
recording to calculate overall precision, recall, and F-score.</p>
<p>Precision ranged from 0.36 at a score threshold of 0.10 to 0.94 at a
score threshold of 0.99 (Figure 1). Recall ranged from 0.01 at a score
threshold of 0.99 to 0.36 of 0.1 F-score was similarly low, ranging from
0.03 at a score threshold of 0.01 to 0.36 at a score threshold of 0.99.
Neither the precision-recall curve nor the plot of F-score relative to
score threshold showed a typical concave down curve shape, suggesting
that a low score threshold of 0.10 would be best to optimize trade-offs
between precision and recall.</p>
<p><img src="classifiers-tutorial_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="deep-learning-in-wildtrax">Deep learning in WildTrax<a class="anchor" aria-label="anchor" href="#deep-learning-in-wildtrax"></a>
</h2>
<p>WildTrax uses BirdNET to automatically classify species in all
recordings that are uploaded to projects, with the classifier run
overnight once the task is uploaded. The sensitivity is set at 1.5 to
reduce the probability of false positives and the score threshold is set
low at 0.1 to allow users to set higher thresholds as needed. The list
of species is filtered by eBird occurrence data for the week of
recording, but not by location.</p>
<div class="section level3">
<h3 id="downloading-the-classifier-reports">Downloading the classifier reports<a class="anchor" aria-label="anchor" href="#downloading-the-classifier-reports"></a>
</h3>
<p>Use <code>wt_download_report(reports = c('main','birdnet'))</code> to
download the BirdNET report and the main report for further analysis.
We’ll use the ABMI Ecosystem Health 2022 dataset as an example.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://abbiodiversity.github.io/wildrtrax/">wildrtrax</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>WT_USERNAME <span class="op">=</span> <span class="st">'guest'</span>, WT_PASSWORD <span class="op">=</span> <span class="st">'Apple123'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/wt_auth.html">wt_auth</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#This line will take a minute to run while it downloads the data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_download_report.html">wt_download_report</a></span><span class="op">(</span>project_id <span class="op">=</span> <span class="fl">1144</span>,</span>
<span>                           sensor_id <span class="op">=</span> <span class="st">"ARU"</span>,</span>
<span>                           reports <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"main"</span>, <span class="st">"birdnet"</span><span class="op">)</span>, </span>
<span>                           weather_cols <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluating">Evaluating<a class="anchor" aria-label="anchor" href="#evaluating"></a>
</h3>
<p>We can combine the main report and the BirdNET report to evaluate the
classifier’s performance on a given dataset. The
<code><a href="../reference/wt_evaluate_classifier.html">wt_evaluate_classifier()</a></code> function takes the output from the
<code><a href="../reference/wt_download_report.html">wt_download_report()</a></code> and joins them together and then
calculates precision, recall, and F-score for the requested sequences of
thresholds. You can request the metrics at the minute level for
recordings that are processed with the species per minute method (1SPM).
You can also exclude species that are not allowed in the project from
the BirdNET results before evaluation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_evaluate_classifier.html">wt_evaluate_classifier</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                              resolution <span class="op">=</span> <span class="st">"task"</span>,</span>
<span>                              remove_species <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">eval</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   precision   recall   fscore threshold</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1 0.002<span style="text-decoration: underline;">00</span>  0.003<span style="text-decoration: underline;">99</span>         95</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         1 0.001<span style="text-decoration: underline;">50</span>  0.002<span style="text-decoration: underline;">99</span>         96</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         1 0.000<span style="text-decoration: underline;">833</span> 0.001<span style="text-decoration: underline;">66</span>         97</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         1 0.000<span style="text-decoration: underline;">666</span> 0.001<span style="text-decoration: underline;">33</span>         98</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         1 0.000<span style="text-decoration: underline;">333</span> 0.000<span style="text-decoration: underline;">666</span>        99</span></span></code></pre>
<p>We can plot the results of our evaluation to get an idea of how
BirdNET is performing:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot.p.e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">eval</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">threshold</span>, y<span class="op">=</span><span class="va">precision</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Score threshold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Precision"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot.r.e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">eval</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">threshold</span>, y<span class="op">=</span><span class="va">recall</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Score threshold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Recall"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot.f.e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">eval</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">threshold</span>, y<span class="op">=</span><span class="va">fscore</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Score threshold"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"F-score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot.pr.e</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">eval</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">recall</span>, y<span class="op">=</span><span class="va">precision</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Recall"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Precision"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plot.p.e</span>, <span class="va">plot.r.e</span>, <span class="va">plot.f.e</span>, <span class="va">plot.pr.e</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="classifiers-tutorial_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="selecting-and-filtering-a-threshold">Selecting and filtering a threshold<a class="anchor" aria-label="anchor" href="#selecting-and-filtering-a-threshold"></a>
</h3>
<p>You can use the precision and recall values in the output of the
<code><a href="../reference/wt_evaluate_classifier.html">wt_evaluate_classifier()</a></code> function to select a score
threshold manually, or you can use the <code><a href="../reference/wt_get_threshold.html">wt_get_threshold()</a></code>
function to select the highest threshold that maximizes F-score.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">threshold_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_get_threshold.html">wt_get_threshold</a></span><span class="op">(</span><span class="va">eval</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 26</span></span></code></pre>
<p>Once a threshold has been selected, the BirdNET report can be
filtered:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birdnet</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">detections</span> <span class="op">&lt;-</span> <span class="va">birdnet</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">confidence</span> <span class="op">&gt;</span> <span class="va">threshold_use</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">detections</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 16</span></span></span>
<span><span class="co">##   organization location location_id project       project_id recording_date_time</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> ABMI         1004-NE       <span style="text-decoration: underline;">310</span>673 Ecosystem He…       <span style="text-decoration: underline;">1</span>144 2022-03-31 <span style="color: #949494;">07:45:00</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 10 more variables: recording_id &lt;dbl&gt;, recording_length &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   scientific_name &lt;chr&gt;, species_common_name &lt;chr&gt;, species_code &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   start_s &lt;dbl&gt;, end_s &lt;dbl&gt;, confidence &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   is_species_allowed_in_project &lt;lgl&gt;, version &lt;chr&gt;</span></span></span></code></pre>
<p>Whether you’re a human or a computer, all classifiers make mistakes.
But we can select a score threshold that maximizes the F-score. Let’s
look at what our precision is:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval</span><span class="op">[</span><span class="va">eval</span><span class="op">$</span><span class="va">threshold</span><span class="op">==</span><span class="va">threshold_use</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   precision recall fscore threshold</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     0.699  0.196  0.306        26</span></span></code></pre>
<p>A precision at our chosen score threshold of approximately
<code>round(eval[eval$threshold==threshold_use,]$precision,3)</code>
means that ~1/3 of detections are likely still false positives, we
should probably visually verify to remove those false positives. Given
that the overall recall rate of BirdNET is &lt; 10% for precision values
above 0.7, the detections should be used with caution in ecological
analyses. From a detectability perspective, a recall rate of 10% means
that your detection probability with BirdNET is 10% of what it would be
with a human listener.</p>
</div>
<div class="section level3">
<h3 id="check-for-additional-species-detected">Check for additional species detected<a class="anchor" aria-label="anchor" href="#check-for-additional-species-detected"></a>
</h3>
<p>One of the potential valuable applications of BirdNET is to check for
the presence of additional species in acoustic recordings that were not
detected by human listeners. <span class="citation">@ware_2023</span>
found that supplementing human listener data with verified computer
listening results improved estimates of species richness, particularly
for water-associated birds.</p>
<p>We can use the <code><a href="../reference/wt_additional_species.html">wt_additional_species()</a></code> function to check
for species reported by BirdNET that the human listeners did not detect
in our project. The input for this function should be the output from
the <code><a href="../reference/wt_download_report.html">wt_download_report()</a></code> function when you request the
<code>main</code> and <code>birdnet</code> reports and you will need to
set a score threshold.</p>
<p>Let’s use a high threshold (80) on our example dataset to see if any
new species are detected. We can use the resolution argument to specify
whether we want to look for new species in each task, recording,
location, or in the entire project. Let’s pretend we’re interested in
site-specific species richness and use the task argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_additional_species.html">wt_additional_species</a></span><span class="op">(</span><span class="va">data</span>, remove_species <span class="op">=</span> <span class="cn">TRUE</span>, threshold <span class="op">=</span> <span class="fl">80</span>, resolution<span class="op">=</span><span class="st">"task"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#potential new detections</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">new</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">new</span><span class="op">$</span><span class="va">species_code</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## AMWI BOOW EVGR </span></span>
<span><span class="co">##    1    1    1</span></span></code></pre>
<p>There are <code>unique(new$species_code)</code> potential new species
detections in our dataset.</p>
<p><span style="display: inline-block; border: 1px solid #000; padding: 5px; background-color: #f0f0f0;">
If no human-generated tags exist in a project, in other words you are
only using classifiers to detect species, additional tags can be easily
synchronized with <code>wt_additional_tags(format_to_tags = TRUE)</code>
along with an output folder. If you are adding additional tags to a
human processed data set, the best approach is sync the tags onto new
tasks. Generate tasks with the ‘Not Assigned’ observer and then sync the
output of <code>wt_additional_tags()</code>. The common error you may
encounter are when there are either conflicts for the number of
individuals assigned relative to the task method. </span></p>
</div>
<div class="section level3">
<h3 id="individual-calls">Individual calls<a class="anchor" aria-label="anchor" href="#individual-calls"></a>
</h3>
<p>Another potential use for BirdNET in WildTrax is to use it to detect
individual calls as opposed to just the first call in each task (1SPT)
or minute (1SPM). This might be of interest if you’re using call rate in
a behavioural analysis, or if you’re looking for detections for tool
development like distance estimation or building a focal species
recognizer. Let’s try it for Clay-coloured Sparrow (CCSP):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Evaluate classifier performance</span></span>
<span><span class="va">eval_ccsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_evaluate_classifier.html">wt_evaluate_classifier</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                              resolution <span class="op">=</span> <span class="st">"task"</span>,</span>
<span>                              remove_species <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              species <span class="op">=</span> <span class="st">"CCSP"</span>,</span>
<span>                              thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Filter the detections to the best threshold</span></span>
<span><span class="va">threshold_ccsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_get_threshold.html">wt_get_threshold</a></span><span class="op">(</span><span class="va">eval_ccsp</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Look at performance at that threshold</span></span>
<span><span class="va">eval_ccsp</span><span class="op">[</span><span class="va">eval_ccsp</span><span class="op">$</span><span class="va">threshold</span><span class="op">==</span><span class="va">threshold_ccsp</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   precision recall fscore threshold</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         1  0.446  0.617        25</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Filter to detections</span></span>
<span><span class="va">detections_ccsp</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species_code</span> <span class="op">==</span> <span class="st">"CCSP"</span>, </span>
<span>         <span class="va">confidence</span> <span class="op">&gt;</span> <span class="va">threshold_ccsp</span><span class="op">)</span></span></code></pre></div>
<p>As before, you’ll probably want to upload your detections to WildTrax
for verification, even though BirdNET performance for Clay-coloured
Sparrow is pretty good. Let’s take a look at our BirdNET output as call
rate to see if it’s higher at the beginning of the season, as we would
expect:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Calculate detections per second and mean confidence in each recording</span></span>
<span><span class="va">rate_ccsp</span> <span class="op">&lt;-</span> <span class="va">detections_ccsp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">location_id</span>, <span class="va">recording_date_time</span>, <span class="va">recording_length</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>calls <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>            confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"keep"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rate <span class="op">=</span> <span class="va">calls</span><span class="op">/</span><span class="va">recording_length</span><span class="op">*</span><span class="fl">60</span>,</span>
<span>         recording_date_time <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">recording_date_time</span><span class="op">)</span>,</span>
<span>         yday <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">yday</a></span><span class="op">(</span><span class="va">recording_date_time</span><span class="op">)</span>,</span>
<span>         hour <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">recording_date_time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Filter to the sites with most recordings with detections</span></span>
<span><span class="va">occupied_ccsp</span> <span class="op">&lt;-</span> <span class="va">rate_ccsp</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">location_id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>recordings <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">recordings</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot call rate by day of year</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">occupied_ccsp</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">yday</span>, y<span class="op">=</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">yday</span>, y<span class="op">=</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Day of year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Rate of Clay-coloured sparrow detections per minute"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="classifiers-tutorial_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="other-applications">Other applications<a class="anchor" aria-label="anchor" href="#other-applications"></a>
</h3>
<p>Visit the <a href="https://github.com/kahst/BirdNET-Analyzer" class="external-link">BirdNET
Github repository</a> to run BirdNET on your own computer. The decision
to pursue other applications should be made with the effect of BirdNET’s
low recall rate in mind:</p>
<ol style="list-style-type: decimal">
<li><p>With presence / absence data, BirdNET is unlikely to be reliably
to confirm absences due to the low recall.</p></li>
<li><p>BirdNET data can be used for occupancy modelling (<span class="citation">@wood_2023</span>), and there are approaches that can
accommodate false positive error rates to preclude verification of all
detections (<span class="citation">@rhinehart_2022</span>). However,
users should keep in mind that occupancy modelling is recommended only
for detection probabilities &gt; 30% and that recall from BirdNET may be
too low for reliable occupancy estimates for many species (<span class="citation">@knight_2017</span>).</p></li>
</ol>
<p>See <span class="citation">@perez-granados_2023</span> for a full
review of BirdNET applications and performance.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex MacPhail, Marcus Becker, Elly Knight.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
